<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLOv5</title>
    <!-- 테일윈드 CSS CDN 링크 -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.17/dist/tailwind.min.css" rel="stylesheet">
    <!-- 토스트 UI CSS CDN 링크 -->
    <link href="https://cdn.jsdelivr.net/npm/toastui/dist/toastui.min.css" rel="stylesheet">
    
</head>
<body>
    <!--<div id="result">
        {% for result in results %}
            <div class="frame">
                <img src="{{ result.save_path }}" alt="Frame {{ loop.index }}" width="300">
                {% set cnt_length = result.cnt|length %}
                {% for i in range(cnt_length) %}
                        <span class="label">{{ result.lab[i] }} : {{ result.cnt[i] }}</span>
                {% endfor %}
            </div>
        {% endfor %}
    </div>-->
    <div id="result-container">
        <div id="image-container">
            <img id="current-image" src="imageElement.src">
        </div>
    </div>
    
    <script>
        var results = [];  // 전역 변수로 결과 배열 선언
    
        // AJAX 요청
        $.ajax({
            url: '/process_video',
            type: 'GET',
            success: function(response) {
                results = response.results;  // 결과를 전역 변수에 저장
                displayNextImage();  // 다음 이미지 출력 함수 호출
            },
            error: function(xhr, status, error) {
                console.error(error);
            }
        });
    
        function displayNextImage() {
            if (results.length > 0) {
                var currentResult = results.shift();  // 배열에서 첫 번째 요소를 가져옴
                var imagePath = currentResult.save_path;  // 이미지 경로
    
                // 이미지 요소에 경로 설정
                var imageElement = document.getElementById('current-image');
                imageElement.src = imagePath;
    
                // 다음 이미지 출력 대기
                setTimeout(displayNextImage, 1000);  // 1초마다 다음 이미지 출력
            }
        }
    </script>

</body>
</html>